(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/member/after_sale/index"],{"2dfe":function(t,e,i){"use strict";var s,a=function(){var t=this,e=t.$createElement;t._self._c},n=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return s}))},"49b2":function(t,e,i){"use strict";i.r(e);var s=i("2dfe"),a=i("a839");for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);i("efcf");var r,o=i("f0c5"),u=Object(o["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);e["default"]=u.exports},"5ef4":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=function(){i.e("components/jihai-lable").then(function(){return resolve(i("3f55"))}.bind(null,i)).catch(i.oe)},a={data:function(){return{type_list:[{value:"1",name:"未收到",checked:!0,disabled:!1},{value:"2",name:"已收到",checked:!1,disabled:!1}],order_id:"",items:[],item_ids:[],aftersale_type:1,refund:0,maxRefund:0,refund_show:0,images:[],reason:"",image_max:5,refund_input_noedit:!0,mode:"aspectFill",submitStatus:!1,checkedItems:[],isFlag:!0,cost_freight:0}},components:{jhlable:s},computed:{isImage:function(){var t=this.image_max-this.images.length;return t>0}},methods:{radioChange:function(t){var e=this;this.type_list.forEach((function(i){i.value===t.target.value?(i.checked=!0,e.aftersale_type=t.target.value):i.checked=!1})),this.type_list[0].checked?this.refund_input_noedit=!0:this.refund_input_noedit=!1},getOrderInfo:function(){var t=this,e={order_id:this.order_id};this.$api.orderDetail(e,(function(e){if(e.status)if(1!=e.data.text_status&&6!=e.data.text_status&&7!=e.data.text_status){var i=t.type_list;2==e.data.text_status&&(i[1].disabled=!0);for(var s,a={},n=0;n<e.data.items.length;n++)e.data.items[n].nums>=e.data.items[n].reship_nums&&(a=e.data.items[n].nums-e.data.items[n].reship_nums),a>0&&(s=!0),e.data.items[n].id=e.data.items[n].id.toString(),e.data.items[n].returnNums=a,e.data.items[n].returnStatus=s,e.data.items[n].checked=!1,e.data.items[n].returnNums>0?e.data.items[n].disabled=!1:e.data.items[n].disabled=!0;t.items=e.data.items,t.refund=t.$common.formatMoney(e.data.order_amount-e.data.refunded,2,""),t.maxRefund=t.$common.formatMoney(e.data.order_amount-e.data.refunded,2,""),t.cost_freight=e.data.cost_freight,t.refund_show=e.data.payed-e.data.refunded,t.type_list=i}else t.$common.errorToBack("订单不可以进行售后");else t.$common.errorToBack("没有找到此订单")}))},checkboxChange:function(t){var e=0;this.item_ids=[];for(var i=0;i<t.detail.value.length;i++)for(var s=t.detail.value[i],a=0;a<this.items.length;a++)this.items[a].id==s&&this.items[a].nums>this.items[a].reship_nums&&(e=this.$refs.input[i].value,this.item_ids=this.item_ids.concat({id:s,nums:e}),console.log(this.item_ids))},onFocus:function(t,e){t.returnNums="",-1==this.checkedItems.indexOf(t.id)&&this.checkedItems.push(t.id),this.items[e].checked=!0,this.getReturnData()},refundFocus:function(t){this.refund=""},updateNum:function(t,e){var i=0;i=this.items[e].nums-this.items[e].reship_nums,i<t.returnNums&&(this.isFlag=!1,this.items[e].returnNums=i,this.$common.errorToShow("您填写的数量不对！")),""==t.returnNums&&(this.items[e].returnNums=i),this.isFlag=!0,this.items[e].returnNums=t.returnNums,this.getReturnData()},getReturnData:function(){var t=0;this.item_ids=[];for(var e=0;e<this.checkedItems.length;e++)for(var i=this.checkedItems[e],s=0;s<this.items.length;s++)if(this.items[s].id==i&&this.items[s].nums>=this.items[s].reship_nums){if(t=this.items[s].nums-this.items[s].reship_nums,!(t>=this.items[s].returnNums))return void this.$common.errorToShow("您填写的数量不对！");t=this.items[s].returnNums,this.item_ids=this.item_ids.concat({id:i,nums:t})}},submit:function(t){var e=this;this.submitStatus=!0;for(var i=[],s=0;s<this.images.length;s++)i=i.concat(this.images[s].image_id);var a=/^[0-9]+(.[0-9]{1,2})?$/;if(!a.test(this.refund))return this.$common.errorToShow("请输入正确金额"),this.submitStatus=!1,!1;if(this.refund>this.refund_show)return this.$common.errorToShow("退款金额过大"),this.submitStatus=!1,!1;if(!this.isFlag)return this.$common.errorToShow("您填写的数量不对！"),this.submitStatus=!1,!1;console.log(this.item_ids);var n={order_id:this.order_id,type:this.aftersale_type,items:this.item_ids,images:i,refund:this.refund,reason:this.reason};n["formId"]=t.detail.formId,this.$api.addAfterSales(n,(function(t){t.status?e.$common.successToShow("提交成功",(function(t){e.$common.navigateTo("/pages/member/order/orderdetail?order_id="+e.order_id)})):e.$common.errorToShow(t.msg)}),(function(t){e.submitStatus=!1}))},upImage:function(){var t=this,e=this.image_max-this.images.length;e>0&&this.$api.uploadImage(e,(function(e){e.status?(t.images.push(e.data),t.$common.successToShow(e.msg)):t.$common.errorToShow(e.msg)}))},delImage:function(t){for(var e=[],i=0;i<this.images.length;i++)this.images[i].image_id!=t.image_id&&e.push(this.images[i]);this.images=e},clickImg:function(e){t.previewImage({urls:e.split()})}},onLoad:function(t){this.order_id=t.order_id,this.getOrderInfo(),this.getReturnData()}};e.default=a}).call(this,i("543d")["default"])},a839:function(t,e,i){"use strict";i.r(e);var s=i("5ef4"),a=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=a.a},b9bf:function(t,e,i){"use strict";(function(t){i("7c19");s(i("66fd"));var e=s(i("49b2"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},eef9:function(t,e,i){},efcf:function(t,e,i){"use strict";var s=i("eef9"),a=i.n(s);a.a}},[["b9bf","common/runtime","common/vendor"]]]);