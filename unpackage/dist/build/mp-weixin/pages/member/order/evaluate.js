(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/member/order/evaluate"],{2178:function(t,e,o){"use strict";var a={uniRate:function(){return o.e("components/uni-rate/uni-rate").then(o.bind(null,"6c75"))}},n=function(){var t=this,e=t.$createElement;t._self._c},r=[];o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return a}))},a16d:function(t,e,o){"use strict";o.r(e);var a=o("d05c"),n=o.n(a);for(var r in a)"default"!==r&&function(t){o.d(e,t,(function(){return a[t]}))}(r);e["default"]=n.a},a43e:function(t,e,o){"use strict";o.r(e);var a=o("2178"),n=o("a16d");for(var r in n)"default"!==r&&function(t){o.d(e,t,(function(){return n[t]}))}(r);o("f945");var i,u=o("f0c5"),s=Object(u["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],i);e["default"]=s.exports},d05c:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o("bbcf"),n=function(){o.e("components/uni-rate/uni-rate").then(function(){return resolve(o("6c75"))}.bind(null,o)).catch(o.oe)},r={mixins:[a.goods],components:{uniRate:n},data:function(){return{orderId:0,info:{},images:[],score:[],textarea:[],isupload:[],rate:5,submitStatus:!1}},onLoad:function(e){this.orderId=e.order_id,this.orderId?this.orderInfo():this.$common.errorToShow("获取失败",(function(){t.navigateBack({delta:1})}))},computed:{maxUploadImg:function(){return this.$store.state.config.image_max}},methods:{orderInfo:function(){var t=this,e={order_id:this.orderId};this.$api.orderDetail(e,(function(e){if(e.status&&e.data.pay_status>=2&&e.data.ship_status>=3&&e.data.confirm>=2&&1===e.data.is_comment){var o=e.data,a=[],n=[],r=[],i=[];o.items.forEach((function(t){a[t.id]=[],n[t.id]="",r[t.id]=!0,i[t.id]=5})),t.info=o,t.images=a,t.textarea=n,t.score=i,t.isupload=r}else t.$common.errorToShow("订单不存在或状态不可评价!")}))},uploadImg:function(t){var e=this;this.$api.uploadFiles((function(o){if(o.status){var a={url:o.data.url,id:o.data.image_id};e.images[t].push(a),e.$common.successToShow(o.msg)}else e.$common.errorToShow(o.msg)}))},removeImg:function(t,e){this.images[t].splice(e,1)},clickImg:function(e){t.previewImage({urls:e.split()})},changeScore:function(t){this.score[t.id]=t.value},toEvaluate:function(){var e=this;this.submitStatus=!0;var o={};this.images.forEach((function(t,a){o[a]={images:t,score:e.score[a],textarea:e.textarea[a]}}));var a={order_id:this.orderId,items:o};this.$api.orderEvaluate(a,(function(o){o.status?e.$common.successToShow(o.msg,(function(e){var o=getCurrentPages(),a=o[o.length-2];void 0!==a&&"pages/member/order/orderlist"===a.route&&(a.$vm.isReload=!0);var n=o[o.length-3];void 0!==n&&"pages/member/order/orderlist"===n.route&&(n.$vm.isReload=!0),t.navigateBack({delta:1})})):e.$common.errorToShow(o.msg)}),(function(t){e.submitStatus=!1}))}},watch:{images:{handler:function(){var t=this;this.images.forEach((function(e,o){t.isupload[o]=!(e.length>t.maxUploadImg)}))},deep:!0}}};e.default=r}).call(this,o("543d")["default"])},dfda:function(t,e,o){"use strict";(function(t){o("7c19");a(o("66fd"));var e=a(o("a43e"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},e04d:function(t,e,o){},f945:function(t,e,o){"use strict";var a=o("e04d"),n=o.n(a);n.a}},[["dfda","common/runtime","common/vendor"]]]);