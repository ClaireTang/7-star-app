(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/index/index"],{"329d":function(t,o,n){"use strict";var e={uniSegmentedControl:function(){return n.e("components/uni-segmented-control/uni-segmented-control").then(n.bind(null,"5a8b"))},uniRate:function(){return n.e("components/uni-rate/uni-rate").then(n.bind(null,"6c75"))},uniLoadMore:function(){return n.e("components/uni-load-more/uni-load-more").then(n.bind(null,"897a"))},lvvPopup:function(){return n.e("components/lvv-popup/lvv-popup").then(n.bind(null,"6125"))},spec:function(){return n.e("components/spec/spec").then(n.bind(null,"088b"))},uniNumberBox:function(){return n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"ec84"))},uniFab:function(){return n.e("components/uni-fab/uni-fab").then(n.bind(null,"f583"))}},i=function(){var t=this,o=t.$createElement,n=(t._self._c,parseFloat(t.product.mktprice));t.$mp.data=Object.assign({},{$root:{m0:n}})},s=[];n.d(o,"b",(function(){return i})),n.d(o,"c",(function(){return s})),n.d(o,"a",(function(){return e}))},"45a8":function(t,o,n){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;n("df48");var e=n("cf70");function i(t){return u(t)||a(t)||r(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,o){if(t){if("string"===typeof t)return c(t,o);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,o):void 0}}function a(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function u(t){if(Array.isArray(t))return c(t)}function c(t,o){(null==o||o>t.length)&&(o=t.length);for(var n=0,e=new Array(o);n<o;n++)e[n]=t[n];return e}var d=function(){n.e("components/uni-segmented-control/uni-segmented-control").then(function(){return resolve(n("5a8b"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components/lvv-popup/lvv-popup").then(function(){return resolve(n("6125"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/uni-number-box/uni-number-box").then(function(){return resolve(n("ec84"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/uni-rate/uni-rate").then(function(){return resolve(n("6c75"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("897a"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/uni-fab/uni-fab").then(function(){return resolve(n("f583"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/spec/spec").then(function(){return resolve(n("088b"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/share/shareByWx").then(function(){return resolve(n("2a91"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/jshop/jshop-content").then(function(){return resolve(n("589b"))}.bind(null,n)).catch(n.oe)},y={components:{uniSegmentedControl:d,lvvPopup:l,uniNumberBox:m,uniRate:f,uniLoadMore:h,uniFab:p,spec:g,jshopContent:v,shareByWx:b},data:function(){return{swiper:{indicatorDots:!0,autoplay:!0,interval:3e3,duration:800},items:["图文详情","商品参数","买家评论"],current:0,goodsId:0,goodsInfo:{},cartNums:0,product:{},goodsParams:[],goodsComments:{loadStatus:"more",page:1,limit:5,list:[]},buyNum:1,minBuyNum:1,type:2,isfav:!1,favLogo:["/static/image/ic-me-collect.png","/static/image/ic-me-collect2.png"],horizontal:"right",vertical:"bottom",direction:"vertical",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#FF7159"},content:[{iconPath:"/static/image/tab-ic-hom-selected.png",selectedIconPath:"/static/image/tab-ic-hom-unselected.png",active:!1,url:"/pages/index/index"},{iconPath:"/static/image/tab-ic-me-selected.png",selectedIconPath:"/static/image/tab-ic-me-unselected.png",active:!1,url:"/pages/member/index/index"}],submitStatus:!1,config:"",goodsShowWord:[],shareUrl:"/pages/share/jump"}},onLoad:function(o){var n=this;""!=o.id&&(this.goodsId=o.id),this.goodsId?(this.getGoodsDetail(),this.getGoodsParams(),this.getGoodsComments()):this.$common.errorToShow("获取失败",(function(){t.navigateBack({delta:1})})),this.getCartNums(),this.$api.shopConfig((function(t){n.config=t,console.log(t),n.goodsShowWord=t.goods_show_word}));var e=this;this.$db.get("userToken")&&this.$api.userInfo({},(function(t){if(t.status){e.userInfo=t.data;var o={};o.nickName=t.data.nickname,o.tel=t.data.mobile,e.kefupara=JSON.stringify(o)}})),this.ifwxl()},onShow:function(){this.submitStatus=!1},computed:{minNums:function(){return this.product.stock>this.minBuyNum?this.minBuyNum:this.product.stock},isSpes:function(){return!(!this.product.hasOwnProperty("default_spes_desc")||!Object.keys(this.product.default_spes_desc).length)},promotion:function(){var t=[];if(this.product.promotion_list)for(var o in this.product.promotion_list)t.push(this.product.promotion_list[o]);return t},shareHref:function(){var t=getCurrentPages(),o=t[t.length-1];return e.apiBaseUrl+"wap/"+o.route+"?id="+this.goodsId},shopMobile:function(){return this.$store.state.config.shop_mobile||0},defaultSpesDesc:function(){return this.product.default_spes_desc}},onReachBottom:function(){2===this.current&&"more"===this.goodsComments.loadStatus&&this.getGoodsComments()},methods:{ifwxl:function(){this.ifwx=this.$common.isWeiXinBrowser()},backBtn:function(){var o=getCurrentPages();o.length>1?t.navigateBack({delta:1}):t.switchTab({url:"/pages/index/index"})},getGoodsDetail:function(){var o=this,n={id:this.goodsId},e=this.$db.get("userToken");e&&(n["token"]=e),this.$api.goodsDetail(n,(function(n){if(1==n.status){var i=n.data,s=n.data.product;o.goodsInfo=i,o.isfav="true"===o.goodsInfo.isfav,o.product=o.spesClassHandle(s),e&&o.goodsBrowsing()}else o.$common.errorToShow(n.msg,(function(){t.navigateBack({delta:1})}))}))},getCartNums:function(){var t=this,o=this.$db.get("userToken");o&&""!=o&&this.$api.getCartNum({},(function(o){o.status&&(t.cartNums=o.data)}))},toshow:function(t){this.type=t,this.$refs.lvvpopref.show()},toclose:function(){this.$refs.lvvpopref.close()},changeSpes:function(o){var n=this,e=o.v,i=o.k,s=this.$db.get("userToken"),r=JSON.parse(this.product.default_spes_desc);r[e][i].hasOwnProperty("product_id")&&r[e][i].product_id&&(this.$refs.spec.changeSpecData(),this.$api.getProductInfo({id:r[e][i].product_id,token:s},(function(t){1==t.status&&(n.buyNum=t.data.stock>n.minBuyNum?n.minBuyNum:t.data.stock,n.product=n.spesClassHandle(t.data))})),t.showLoading({title:"加载中"}),setTimeout((function(){t.hideLoading()}),1e3))},spesClassHandle:function(t){if(t.hasOwnProperty("default_spes_desc")){var o=t.default_spes_desc;for(var n in o)for(var e in o[n])o[n][e].hasOwnProperty("is_default")&&!0===o[n][e].is_default?this.$set(o[n][e],"cla","pop-m-item selected"):o[n][e].hasOwnProperty("product_id")&&o[n][e].product_id?this.$set(o[n][e],"cla","pop-m-item not-selected"):this.$set(o[n][e],"cla","pop-m-item none");o=JSON.stringify(o),t.default_spes_desc=o}return t},bindChange:function(t){this.buyNum=t},collection:function(){var t=this,o={goods_id:this.goodsInfo.id};this.$api.goodsCollection(o,(function(o){o.status?(t.isfav=!t.isfav,t.$common.successToShow(o.msg)):t.$common.errorToShow(o.msg)}))},onClickItem:function(t){this.current!==t&&(this.current=t)},getGoodsParams:function(){var t=this;this.$api.goodsParams({id:this.goodsId},(function(o){1==o.status&&(t.goodsParams=o.data)}))},getGoodsComments:function(){var t=this,o={page:this.goodsComments.page,limit:this.goodsComments.limit,goods_id:this.goodsId};this.goodsComments.loadStatus="loading",this.$api.goodsComment(o,(function(o){if(1==o.status){var n=o.data.list,e=o.data.count;t.items=["图文详情","商品参数","买家评论("+e+")"],n.forEach((function(o){o.ctime=t.$common.timeToDate(o.ctime,!0),o.hasOwnProperty("images_url")||t.$set(o,"images_url",[])})),t.goodsComments.list=[].concat(i(t.goodsComments.list),i(n)),o.data.count>t.goodsComments.list.length?(t.goodsComments.loadStatus="more",t.goodsComments.page++):t.goodsComments.loadStatus="noMore"}else t.$common.errorToShow(o.msg)}))},goodsBrowsing:function(){var t={goods_id:this.goodsInfo.id};this.$api.addGoodsBrowsing(t,(function(t){}))},addToCart:function(){var t=this;if(this.buyNum>0){var o={product_id:this.product.id,nums:this.buyNum};this.$api.addCart(o,(function(o){o.status?(t.toclose(),t.getCartNums(),t.$common.successToShow(o.msg)):t.$common.errorToShow(o.msg)}),(function(o){t.submitStatus=!1}))}},buyNow:function(){var t=this;if(this.buyNum>0){var o={product_id:this.product.id,nums:this.buyNum,type:2};this.$api.addCart(o,(function(o){if(o.status){t.toclose();var n=o.data;t.$common.navigateTo("/pages/goods/place-order/index?cart_ids="+JSON.stringify(n))}else t.$common.errorToShow(o.msg)}),(function(o){t.submitStatus=!1}))}},redirectCart:function(){t.switchTab({url:"/pages/cart/index/index"})},clickHandle:function(){this.submitStatus=!0,1===this.type?this.addToCart():this.buyNow()},trigger:function(o){this.content[o.index].active=!o.item.active,t.switchTab({url:o.item.url})},goShare:function(){this.$refs.share.show()},closeShare:function(){this.$refs.share.close()},clickImg:function(o){t.previewImage({urls:o.split()})},showChat:function(){},getShareUrl:function(){var t=this,o={client:2,url:"/pages/share/jump",type:1,page:2,params:{goods_id:this.goodsInfo.id}},n=this.$db.get("userToken");n&&""!=n&&(o["token"]=n),this.$api.share(o,(function(o){t.shareUrl=o.data}))}},watch:{goodsInfo:{handler:function(){this.getShareUrl()},deep:!0}},onShareAppMessage:function(){return{title:this.goodsInfo.name,imageUrl:this.goodsInfo.album[0],path:this.shareUrl}}};o.default=y}).call(this,n("543d")["default"])},"7add":function(t,o,n){"use strict";(function(t){n("7c19");e(n("66fd"));var o=e(n("a185"));function e(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,n("543d")["createPage"])},"7c69":function(t,o,n){"use strict";var e=n("f30e"),i=n.n(e);i.a},"901e":function(t,o,n){"use strict";n.r(o);var e=n("45a8"),i=n.n(e);for(var s in e)"default"!==s&&function(t){n.d(o,t,(function(){return e[t]}))}(s);o["default"]=i.a},a185:function(t,o,n){"use strict";n.r(o);var e=n("329d"),i=n("901e");for(var s in i)"default"!==s&&function(t){n.d(o,t,(function(){return i[t]}))}(s);n("7c69");var r,a=n("f0c5"),u=Object(a["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],r);o["default"]=u.exports},f30e:function(t,o,n){}},[["7add","common/runtime","common/vendor"]]]);