(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/form/detail/form"],{5683:function(t,e,o){"use strict";o.r(e);var s=o("e922"),i=o.n(s);for(var n in s)"default"!==n&&function(t){o.d(e,t,(function(){return s[t]}))}(n);e["default"]=i.a},"857b":function(t,e,o){},9147:function(t,e,o){"use strict";(function(t){o("7c19");s(o("66fd"));var e=s(o("b692"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},b692:function(t,e,o){"use strict";o.r(e);var s=o("e834"),i=o("5683");for(var n in i)"default"!==n&&function(t){o.d(e,t,(function(){return i[t]}))}(n);o("d97c");var a,r=o("f0c5"),c=Object(r["a"])(i["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],a);e["default"]=c.exports},d97c:function(t,e,o){"use strict";var s=o("857b"),i=o.n(s);i.a},e834:function(t,e,o){"use strict";var s={lvvPopup:function(){return o.e("components/lvv-popup/lvv-popup").then(o.bind(null,"6125"))}},i=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return n})),o.d(e,"a",(function(){return s}))},e922:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=function(){o.e("components/area-picker/areaPicker").then(function(){return resolve(o("5c79"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/lvv-popup/lvv-popup").then(function(){return resolve(o("6125"))}.bind(null,o)).catch(o.oe)},n={name:"",components:{areaPicker:s,lvvPopup:i},props:{},data:function(){return{formId:"",form:{head_type:1,head_type_value_url:""},showPage:!0,hiddenForm:!0,indicatorDots:!0,autoplay:!0,interval:3e3,duration:500,slideImg:[],minusStatus:"disabled",animationData:{},opacityData:{},hide:"animathide",formMoney:0,region:["河南省","郑州市","中原区"],areaId:410102,pickerValue:"",defaultIndex:[0,0,0],pics:[],goodsNums:0,cart:[],currentKey:0,currentGoodsId:0,goodsTotalMoney:"0.00",originForm:[],paymentType:"",payment_type:"",goodsSpesDesc:"",productId:"",status:"",goodsInfoName:"",goodsInfoPrint:"",goodsInfoNumber:"",select_goods_id:"",select_id:"",showSpecs:!1,submitStatus:!1,shareUrl:"/pages/share/jump"}},onLoad:function(t){var e=t.id;if(!e)return this.$common.errorToShow("路径错误"),!1;this.formId=e,this.$db.set("formId",e)},onShow:function(){this.getFormDetail()},methods:{showThreePicker:function(){this.pickerValue=this.region[0]+" "+this.region[1]+" "+this.region[2],this.$refs.areaPicker[0].showPicker()},onConfirm:function(e){var o=this,s=e[0].name,i=e[1].name,n=e[2].name;this.pickerValue=e[0].name+" "+e[1].name+" "+e[2].name;var a={province_name:s,city_name:i,county_name:n};this.$api.getAreaId(a,(function(e){e.status?o.areaId=e.data:t.showModal({title:"提示",content:"地区选择出现问题，请重新选择地区",showCancel:!1})}))},getFormDetail:function(){var e=this,o={id:this.formId,token:this.$db.get("userToken")},s=this;this.$api.getFormDetial(o,(function(o){o.status?(e.form=o.data,e.originForm=o.data,"1"!=o.data.type&&"2"!=o.data.type||("1"==o.data.type?s.payment_type=e.$config.paymentType.form_order:"2"==o.data.type&&(s.payment_type=e.$config.paymentType.form_pay)),t.setNavigationBarTitle({title:o.data.name})):(e.showPage=!1,"undefined"==typeof o.data.need_login?t.showModal({title:"提示",content:"表单已过期，请扫描新的二维码",showCancel:!1,success:function(e){e.confirm&&t.switchTab({url:"../../index/index"})}}):(e.$store.commit({type:"redirect",page:"/pages/form/detail/form?id="+e.formId}),e.$common.jumpToLogin()))}))},bindDateChange:function(t,e){e.default_value=t.target.value},bindTimeChange:function(t,e){e.default_value=t.target.value},radioChange:function(t,e){e.default_value=t.detail.value},checkboxChange:function(t,e){for(var o=t.detail.value,s=0;s<e.checbox_value.length;++s){var i=e.checbox_value[s];o.includes(i.value)?this.$set(i,"checked",!0):this.$set(i,"checked",!1)}},bindMinus:function(){this.goodsNums>1?this.goodsNums--:this.goodsNums=0},bindPlus:function(){this.goodsNums>=this.goodsInfoNumber?this.goodsNums=this.goodsInfoNumber:this.goodsNums++},bindManual:function(t){this.num=t.detail.value},chooseLocation:function(e,o,s){var i=getCurrentPages(),n=i[0].$vm.form.items,a=this;t.chooseLocation({success:function(t){o.default_value=t.latitude+","+t.longitude,n[s]=o,setTimeout((function(){a.form.items=n}),500)},fail:function(e){t.getSetting({success:function(e){e.authSetting["scope.userLocation"]||t.openSetting()}})}})},pic_choose:function(t,e,o){var s=this,i=getCurrentPages();if(i.length>1)var n=i[1].$vm.form.items;else n=i[0].$vm.form.items;this.$api.uploadImage(5,(function(t){t.status?(e.pics||(e.pics=[]),e.pics.push({src:t.data.url.replace(/\\/g,"/"),image_id:t.data.image_id}),n[o]=e,s.form.items=n,s.$common.successToShow(t.msg)):s.$common.errorToShow(t.msg)}))},pic_del:function(t,e,o){t.pics.splice(o,1),this.$set(this.form.items,e,t)},formSubmit:function(t){var e=this,o=this,s=t.detail.value;if(1==this.form.type){if(this.cart.length<1)return this.$common.errorToShow("请先选择商品"),!0;var i=[];this.cart.forEach((function(t,e,o){i[t.key+"_"+e]=t})),s=Object.assign(s,i)}var n=this.$db.get("userToken"),a={data:s,id:this.form.id,token:n};this.submitStatus=!0,this.$api.addSubmitForm(a,(function(t){t.status?"1"==o.form.type||"2"==o.form.type?(o.$common.successToShow(t.msg),setTimeout((function(){o.$common.redirectTo("/pages/goods/payment/index?form_id="+t.data.id+"&type="+o.payment_type+"&recharge="+t.data.money)}),1e3)):(o.formReset(),o.$common.successToShow(t.msg),setTimeout((function(){wx.switchTab({url:"../../index/index"})}),1500)):e.$common.errorToShow(t.msg)}),(function(t){e.submitStatus=!1}))},formReset:function(t){this.$db.set("formId",""),this.cart=[],this.form=this.originForm},closeModal:function(){this.$refs.lvvpopref.close()},specifications:function(t,e){this.$refs.lvvpopref.show(),this.showSpecs=!0,this.select_id=t.target.dataset.id,this.select_goods_id=t.target.dataset.goods,this.currentKey=t.target.dataset.id,this.currentGoodsId=t.target.dataset.goods,this.getGoodsInfo(e)},getGoodsInfo:function(t){var e=t.goods;this.goodsSpesDesc=this.getSpes(e.product),this.productId=e.product.id,this.goodsInfoName=e.product.name,this.goodsInfoPrint=e.product.price,this.goodsInfoNumber=e.product.stock,this.goodsNums=this.getNumsByKey(this.currentKey,e.product.id),this.status=!(e.product.stock<1)},getNumsByKey:function(t,e){var o=this;if(o.cart.length<1)return 0;for(var s=0;s<o.cart.length;s++)if(o.cart[s].key==t&&o.cart[s].productId==e)return o.cart[s].nums;return 0},goodsAddCart:function(){var t=this.productId,e=this.currentKey;if(this.cart.length<1)this.cart.push({key:e,productId:t,goodsId:this.select_goods_id,nums:this.goodsNums,price:this.goodsInfoPrint});else{for(var o=!1,s=0;s<this.cart.length;s++)this.cart[s].key==e&&this.cart[s].productId==t&&(this.cart[s]={key:e,productId:t,goodsId:this.select_goods_id,nums:this.goodsNums,price:this.goodsInfoPrint},o=!0);o||this.cart.push({key:e,productId:t,goodsId:this.select_goods_id,nums:this.goodsNums,price:this.goodsInfoPrint})}this.showSpecs=!1,this.$refs.lvvpopref.close(),this.getCartNums()},getCartNums:function(){for(var t=this.form.items,e="",o=0,s=t.length;o<s;++o)t[o].id==this.currentKey&&(e=o);var i=this;if(this.form.items[e].goods.id==this.currentGoodsId)if(this.form.items[e].cart_count>0){var n=0,a=this.currentKey;this.cart.forEach((function(t,o,s){t.key==a&&(n+=t.nums),i.form.items[e].cart_count=n}))}else this.form.items[e].cart_count=this.goodsNums;else this.form.items[e].cart_count=this.goodsNums;this.getGoodsTotalMoney()},getGoodsTotalMoney:function(){var t=0;this.cart.forEach((function(e,o,s){t+=e.price*e.nums})),this.goodsTotalMoney=this.$common.formatMoney(t,2,"")},getSpes:function(t){return t.default_spes_desc?t.default_spes_desc:[]},selectSku:function(t){var e=this,o=t.target.dataset.key;this.$api.getProductInfo({id:o},(function(t){t.status&&(e.goodsSpesDesc=e.getSpes(t.data),e.productId=t.data.id,e.goodsInfoName=t.data.name,e.goodsInfoPrint=t.data.price,e.goodsInfoNumber=t.data.stock,e.goodsNums=e.getNumsByKey(e.currentKey,t.data.id),e.status=!(t.data.stock<1))}))},getShareUrl:function(){var t=this,e={client:2,url:"/pages/share/jump",type:1,page:8,params:{id:this.formId}},o=this.$db.get("userToken");o&&""!=o&&(e["token"]=o),this.$api.share(e,(function(e){t.shareUrl=e.data}))}},watch:{formId:{handler:function(){this.getShareUrl()},deep:!0}},onShareAppMessage:function(){return{title:this.form.name,path:this.shareUrl}}};e.default=n}).call(this,o("543d")["default"])}},[["9147","common/runtime","common/vendor"]]]);